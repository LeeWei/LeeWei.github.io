<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack打包优化 | LeeWei</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="时光荏苒，不容辜负">
    <link rel="preload" href="/assets/css/0.styles.3d861c3a.css" as="style"><link rel="preload" href="/assets/js/app.7d901b5e.js" as="script"><link rel="preload" href="/assets/js/2.06a2725e.js" as="script"><link rel="preload" href="/assets/js/63.ea10f1a8.js" as="script"><link rel="prefetch" href="/assets/js/10.70dd4784.js"><link rel="prefetch" href="/assets/js/11.17ceb3a1.js"><link rel="prefetch" href="/assets/js/12.027b01f6.js"><link rel="prefetch" href="/assets/js/13.c709186e.js"><link rel="prefetch" href="/assets/js/14.78644367.js"><link rel="prefetch" href="/assets/js/15.015c1fa5.js"><link rel="prefetch" href="/assets/js/16.a5524904.js"><link rel="prefetch" href="/assets/js/17.6422e408.js"><link rel="prefetch" href="/assets/js/18.4e9f34a3.js"><link rel="prefetch" href="/assets/js/19.c0ee2b68.js"><link rel="prefetch" href="/assets/js/20.49f85742.js"><link rel="prefetch" href="/assets/js/21.1d2d098f.js"><link rel="prefetch" href="/assets/js/22.2ad8915e.js"><link rel="prefetch" href="/assets/js/23.79335352.js"><link rel="prefetch" href="/assets/js/24.c4318513.js"><link rel="prefetch" href="/assets/js/25.7e150338.js"><link rel="prefetch" href="/assets/js/26.e84ed601.js"><link rel="prefetch" href="/assets/js/27.b8cd0ca2.js"><link rel="prefetch" href="/assets/js/28.d8132e9a.js"><link rel="prefetch" href="/assets/js/29.efd4fe18.js"><link rel="prefetch" href="/assets/js/3.42d0a277.js"><link rel="prefetch" href="/assets/js/30.9dcb72e7.js"><link rel="prefetch" href="/assets/js/31.80327726.js"><link rel="prefetch" href="/assets/js/32.afe039d9.js"><link rel="prefetch" href="/assets/js/33.d3f5b913.js"><link rel="prefetch" href="/assets/js/34.d25afac4.js"><link rel="prefetch" href="/assets/js/35.96a61632.js"><link rel="prefetch" href="/assets/js/36.e3021659.js"><link rel="prefetch" href="/assets/js/37.171e55c8.js"><link rel="prefetch" href="/assets/js/38.20197aa0.js"><link rel="prefetch" href="/assets/js/39.f295f048.js"><link rel="prefetch" href="/assets/js/4.880d621f.js"><link rel="prefetch" href="/assets/js/40.e9c492b5.js"><link rel="prefetch" href="/assets/js/41.dab7f199.js"><link rel="prefetch" href="/assets/js/42.3cc57c31.js"><link rel="prefetch" href="/assets/js/43.bc73774d.js"><link rel="prefetch" href="/assets/js/44.5979dbbd.js"><link rel="prefetch" href="/assets/js/45.82bb6608.js"><link rel="prefetch" href="/assets/js/46.9e8ff3cd.js"><link rel="prefetch" href="/assets/js/47.bd31e67c.js"><link rel="prefetch" href="/assets/js/48.aba7685f.js"><link rel="prefetch" href="/assets/js/49.7dccbe8a.js"><link rel="prefetch" href="/assets/js/5.14cd14b8.js"><link rel="prefetch" href="/assets/js/50.b8eb05b4.js"><link rel="prefetch" href="/assets/js/51.ae2bce1a.js"><link rel="prefetch" href="/assets/js/52.12fd6a7e.js"><link rel="prefetch" href="/assets/js/53.0c2fac0c.js"><link rel="prefetch" href="/assets/js/54.ac6462fa.js"><link rel="prefetch" href="/assets/js/55.a3d3a858.js"><link rel="prefetch" href="/assets/js/56.d11a53cb.js"><link rel="prefetch" href="/assets/js/57.222d7dfe.js"><link rel="prefetch" href="/assets/js/58.7293170e.js"><link rel="prefetch" href="/assets/js/59.ff962efc.js"><link rel="prefetch" href="/assets/js/6.3bad40c8.js"><link rel="prefetch" href="/assets/js/60.6a3d63bc.js"><link rel="prefetch" href="/assets/js/61.b2f8e57a.js"><link rel="prefetch" href="/assets/js/62.a22cb1dc.js"><link rel="prefetch" href="/assets/js/64.bce9b53b.js"><link rel="prefetch" href="/assets/js/65.8da84c46.js"><link rel="prefetch" href="/assets/js/66.7f1090f8.js"><link rel="prefetch" href="/assets/js/67.e1cbc56e.js"><link rel="prefetch" href="/assets/js/68.052910c2.js"><link rel="prefetch" href="/assets/js/69.e2f2886b.js"><link rel="prefetch" href="/assets/js/7.6e1a4025.js"><link rel="prefetch" href="/assets/js/70.07395612.js"><link rel="prefetch" href="/assets/js/71.6fd275b7.js"><link rel="prefetch" href="/assets/js/72.24385907.js"><link rel="prefetch" href="/assets/js/73.e134522b.js"><link rel="prefetch" href="/assets/js/74.1c6f77cf.js"><link rel="prefetch" href="/assets/js/8.ad5e7d31.js"><link rel="prefetch" href="/assets/js/9.a1c6328b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3d861c3a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/headLogo.png" alt="LeeWei" class="logo"> <span class="site-name can-hide">LeeWei</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technology-sharing/html+css/" class="nav-link">
  html+css
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/js/" class="nav-link">
  js基础入门
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/jquery/" class="nav-link">
  jquery
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/vue/" class="nav-link">
  全面拥抱Vue
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/ts/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/wx/" class="nav-link">
  微信小程序
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/node/" class="nav-link">
  node.js
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/webpack/" class="nav-link router-link-active">
  webpack
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technology-sharing/php/" class="nav-link">
  php
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/JAVA/" class="nav-link">
  JAVA
</a></li></ul></div></div><div class="nav-item"><a href="/technology-sharing/jsDir/" class="nav-link">
  js公共方法
</a></div><div class="nav-item"><a href="/technology-sharing/bigData/" class="nav-link">
  大数据
</a></div><div class="nav-item"><a href="/tools/" class="nav-link">
  实用工具
</a></div><div class="nav-item"><a href="/About/" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technology-sharing/html+css/" class="nav-link">
  html+css
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/js/" class="nav-link">
  js基础入门
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/jquery/" class="nav-link">
  jquery
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/vue/" class="nav-link">
  全面拥抱Vue
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/ts/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/wx/" class="nav-link">
  微信小程序
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/node/" class="nav-link">
  node.js
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/webpack/" class="nav-link router-link-active">
  webpack
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technology-sharing/php/" class="nav-link">
  php
</a></li><li class="dropdown-item"><!----> <a href="/technology-sharing/JAVA/" class="nav-link">
  JAVA
</a></li></ul></div></div><div class="nav-item"><a href="/technology-sharing/jsDir/" class="nav-link">
  js公共方法
</a></div><div class="nav-item"><a href="/technology-sharing/bigData/" class="nav-link">
  大数据
</a></div><div class="nav-item"><a href="/tools/" class="nav-link">
  实用工具
</a></div><div class="nav-item"><a href="/About/" class="nav-link">
  关于我
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/technology-sharing/webpack/" aria-current="page" class="sidebar-link">webpack配置</a></li><li><a href="/technology-sharing/webpack/webpack打包优化.html" class="active sidebar-link">webpack打包优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/technology-sharing/webpack/webpack打包优化.html#优化图片" class="sidebar-link">优化图片</a></li><li class="sidebar-sub-header"><a href="/technology-sharing/webpack/webpack打包优化.html#分离第三方包" class="sidebar-link">分离第三方包</a></li><li class="sidebar-sub-header"><a href="/technology-sharing/webpack/webpack打包优化.html#分离css并压缩css文件" class="sidebar-link">分离css并压缩css文件</a></li><li class="sidebar-sub-header"><a href="/technology-sharing/webpack/webpack打包优化.html#压缩js文件" class="sidebar-link">压缩js文件</a></li><li class="sidebar-sub-header"><a href="/technology-sharing/webpack/webpack打包优化.html#压缩html" class="sidebar-link">压缩html</a></li><li class="sidebar-sub-header"><a href="/technology-sharing/webpack/webpack打包优化.html#优化loader的搜索范围，从而减少打包时间" class="sidebar-link">优化loader的搜索范围，从而减少打包时间</a></li><li class="sidebar-sub-header"><a href="/technology-sharing/webpack/webpack打包优化.html#happypack-可以将同步转为为并行" class="sidebar-link">HappyPack 可以将同步转为为并行</a></li><li class="sidebar-sub-header"><a href="/technology-sharing/webpack/webpack打包优化.html#dllplugin-可以将特定类库提前打包然后引用-从而极大减少类库的打包次数。只有当类库版本更新时才会重新打包。" class="sidebar-link">Dllplugin 可以将特定类库提前打包然后引用 从而极大减少类库的打包次数。只有当类库版本更新时才会重新打包。</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>webpack的打包优化分为减少打包时间、减少打包的大小</p></blockquote> <h1 id="减少打包大小"><a href="#减少打包大小" class="header-anchor">#</a> 减少打包大小</h1> <h2 id="优化图片"><a href="#优化图片" class="header-anchor">#</a> 优化图片</h2> <ul><li>使用url-loader将小图片转化为base64压缩，防止小图片太多请求次数过多</li> <li>安装url-loader npm install url-loader</li> <li>配置webpack.prod.conf,js</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code> module<span class="token operator">:</span> <span class="token punctuation">{</span>
      rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
         test<span class="token operator">:</span> <span class="token regex">/\.(png|svg|jpg|gif)$/</span><span class="token punctuation">,</span>
         use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
           loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span> <span class="token comment">// 优化小图片过多造成请求数太多</span>
           options<span class="token operator">:</span> <span class="token punctuation">{</span>
             limit<span class="token operator">:</span> <span class="token number">8192</span><span class="token punctuation">,</span> <span class="token comment">// 如果图片小于 8192 bytes 就直接 base64 内置到模板，否则才拷贝</span>
             outputPath<span class="token operator">:</span> <span class="token string">'img/'</span>
           <span class="token punctuation">}</span> 
         <span class="token punctuation">}</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="分离第三方包"><a href="#分离第三方包" class="header-anchor">#</a> 分离第三方包</h2> <ul><li>使用CommonsChunkPlugin 插件进行配置</li> <li>引入webapck</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code> entry<span class="token operator">:</span> <span class="token punctuation">{</span>
         vendor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-polyfill'</span><span class="token punctuation">,</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;marked&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react-router-dom&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 第三方文件</span>
         app<span class="token operator">:</span> <span class="token string">'./src/main.js'</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
       plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
         <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
           name<span class="token operator">:</span> <span class="token string">&quot;vendor&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 当加载 vendor 中的资源的时候，把这些资源都合并到 vendor.js 文件中</span>
           filename<span class="token operator">:</span> <span class="token string">&quot;js/vendor.js&quot;</span><span class="token punctuation">,</span>
           minChunks<span class="token operator">:</span> <span class="token number">Infinity</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="分离css并压缩css文件"><a href="#分离css并压缩css文件" class="header-anchor">#</a> 分离css并压缩css文件</h2> <ul><li>安装 extract-text-webpack-plugin</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm  install  <span class="token operator">-</span><span class="token constant">D</span>  extract<span class="token operator">-</span>text<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>引入并使用extract-text-webpack-plugin 插件将css单独分离</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;extract-text-webpack-plugin&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>配置分离 css 文件</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;extract-text-webpack-plugin&quot;</span><span class="token punctuation">)</span>
 module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
     <span class="token comment">//  入口文件的配置项</span>
     entry<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token comment">// 出口文件的配置项</span>
     output<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token comment">// 模块 解析CSS和图片转换压缩等功能。</span>
     module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
           test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
           use<span class="token operator">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  fallback<span class="token operator">:</span> <span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span>  <span class="token comment">//这个地方配置一个对象，添加一个属性进行压缩css文件</span>
                  use<span class="token operator">:</span> <span class="token punctuation">{</span>
                        loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
                       options<span class="token operator">:</span> <span class="token punctuation">{</span>
                            minimize<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//配置minimize 值为true，压缩css 文件</span>
                       <span class="token punctuation">}</span>
                 <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">}</span><span class="token punctuation">]</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token comment">// 插件，用于商城模块的各项功能</span>
     pugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token string">&quot;css/styles.css&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 把抽离出来的 css 文件打包到 styles.css 文件中</span>
     <span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token comment">// 用于配置webpack开发服务功能</span>
     devServer<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="压缩js文件"><a href="#压缩js文件" class="header-anchor">#</a> 压缩js文件</h2> <ul><li>使用uglifyjs-webpack-plugin 压缩js 下载安装 npm install -D uglifyjs-webpack-plugi</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Uglifyjs<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;uglify-webpack-plugin&quot;</span><span class="token punctuation">)</span> 
 plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 压缩 JavaScript</span>
           <span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="压缩html"><a href="#压缩html" class="header-anchor">#</a> 压缩html</h2> <ul><li>使用html-webpack-plugin 安装html-webpack-plugin</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
             <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
               template<span class="token operator">:</span> <span class="token string">'./index.html'</span><span class="token punctuation">,</span> <span class="token comment">// 把 index.html 也打包到 dist 目录中</span>
             <span class="token comment">// 压缩 html，默认 false 不压缩</span>
              minify<span class="token operator">:</span> <span class="token punctuation">{</span>
                  collapseWhitespace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 去除回车换行符以及多余空格</span>
                 removeComments<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 删除注释</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h1 id="减少打包时间"><a href="#减少打包时间" class="header-anchor">#</a> 减少打包时间</h1> <h2 id="优化loader的搜索范围，从而减少打包时间"><a href="#优化loader的搜索范围，从而减少打包时间" class="header-anchor">#</a> 优化loader的搜索范围，从而减少打包时间</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span> <span class="token comment">// 对js文件使用babel</span>
            loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
            include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">// 只在src文件夹下查找</span>
            <span class="token comment">// 不去查找的文件夹路径，node_modules下的代码是编译过得，没必要再去处理一遍</span>
            exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span> 
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="happypack-可以将同步转为为并行"><a href="#happypack-可以将同步转为为并行" class="header-anchor">#</a> HappyPack 可以将同步转为为并行</h2> <blockquote><p>因为node是单线程运行，webpack也是单线程的。HappyPack 可以将同步转为并行，从而减少执行loader时编译所需等待时间</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
    loaders<span class="token operator">:</span> <span class="token punctuation">[</span>
        test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">'happypack/loader?id=happybabel'</span> <span class="token comment">//id对应插件下的配置的id</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token string">'happybabel'</span><span class="token punctuation">,</span>
        loaders<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader?cacheDirectory'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        threads<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// 线程开启数</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="dllplugin-可以将特定类库提前打包然后引用-从而极大减少类库的打包次数。只有当类库版本更新时才会重新打包。"><a href="#dllplugin-可以将特定类库提前打包然后引用-从而极大减少类库的打包次数。只有当类库版本更新时才会重新打包。" class="header-anchor">#</a> Dllplugin 可以将特定类库提前打包然后引用 从而极大减少类库的打包次数。只有当类库版本更新时才会重新打包。</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.dll.conf.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        vendor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">]</span> <span class="token comment">// 需要统一打包的类库</span>
    <span class="token punctuation">}</span>，
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>
        library<span class="token operator">:</span> <span class="token string">'[name]-[hash]'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'[name]-[hash]'</span><span class="token punctuation">,</span> <span class="token comment">//name必须要和output.library一致</span>
            context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span> <span class="token comment">//注意与DllReferencePlugin的context匹配一致</span>
            path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'[name]-manifest.json'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li>在package.json文件中增加一个脚本</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">'dll'</span><span class="token operator">:</span> <span class="token string">'webpack  --config webpack.dll.js --mode==development'</span>
<span class="token comment">//运行后会打包出react.dll.js和manifest.json两个依赖文件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>使用DllReferencePlugin</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      context<span class="token operator">:</span>__dirname<span class="token punctuation">,</span>
       manifest<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dist/vendor-manifest.json'</span><span class="token punctuation">)</span> <span class="token comment">//此即打包出来的json文件</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/technology-sharing/webpack/" class="prev router-link-active">
        webpack配置
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7d901b5e.js" defer></script><script src="/assets/js/2.06a2725e.js" defer></script><script src="/assets/js/63.ea10f1a8.js" defer></script>
  </body>
</html>
